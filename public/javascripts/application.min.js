var dTableConfig={"bJQueryUI":true,"sPaginationType":"full_numbers","aLengthMenu":[[10,25,50,100,-1],[10,25,50,100,"Tudo"]],"oLanguage":{"sLengthMenu":"_MENU_ itens por p\u00e1gina","sZeroRecords":"Nenhum registro encontrado","sInfo":"Registros de _START_ at\u00e9 _END_ de um total de _TOTAL_","sInfoEmpty":"Registros de 0 at\u00e9 0 de um total de 0","sInfoFiltered":"(filtrado de um total de _MAX_ registros)","sProcessing":"Processando...","sInfoPostFix":"","sSearch":"Busca","sUrl":"","oPaginate":{"sFirst":"Primeira",
"sPrevious":"Anterior","sNext":"Pr\u00f3xima","sLast":"\u00daltima"}},"bRetrieve":true};
$(function(){$("body").layout({north__size:60,north__slidable:false,north__closable:false,north__resizable:false,west__slidable:false,west__closable:false,west__resizable:false,east__slidable:false,east__closable:true,east__resizable:false,east__minSize:237});$("#menu").accordion({fillSpace:true});make_buttons();$("input[type=submit], .button.save").live("click",function(){$(".mask-decimal").each(function(){var t=$(this);t.val(format.decimal.toNumber(t.val()))});form=$("form");url=form.attr("action");
fdata=form.serializeArray();$.ajax({url:url,data:fdata,type:"POST",dataType:"html",success:function(data){$(".ui-layout-center").empty().append(data)}});return false});$("form input").live("keydown",function(e){if(e.which=="13")return false});$("table.list tbody tr").live("click",function(){t=$(this);ctrl=$("#controller").val();id=$(":first-child",t).html();if(!isNaN(id)){klass="ui-state-default";$("table.list tbody tr."+klass).removeClass(klass);t.addClass(klass);url="/"+ctrl+"/";$(".button.show").attr("href",
url+id);$(".button.edit").attr("href",url+id+"/edit");$(".button.delete").attr("href",url+id);$(".button.editpass").attr("href",url+"editpass/"+id);$(".button.show, .button.edit, .button.delete, .button.editpass").button({disabled:false})}else $(".button.show, .button.edit, .button.delete, .button.editpass").attr("href","#").button({disabled:true})});$("table.list tbody tr").live("dblclick",function(){$(".button.show").click()});$("#menu a[href*=/], .ui-layout-center a[href*=/], .ui-layout-north a[href*=/][ajax=true]").live("click",
function(){t=$(this);url=t.attr("href");data="";type="GET";dataType="html";if(url=="#")return false;rgx_json=/json$/gi;is_json=rgx_json.test(url);if(t.hasClass("delete")||t.hasClass("confirm")){data="_method=delete";type="POST";if(!confirm("Tem certeza?"))return false}if(t.attr("ajax")!="false"){$.ajax({url:url,data:data,type:type,dataType:dataType,success:function(data){if(is_json)eval(data);else $(".ui-layout-center").empty().append(data)}});return false}});$(".button.upload").live("click",function(){t=
$(this);showDialog(t.attr("href"));return false});$("body").ajaxStart(function(){$("#errorExplanation").slideUp("fast");$("#waiting").fadeTo("normal",0.9)});$("body").ajaxSuccess(function(){$("#errorExplanation").hide().slideDown("slow");$("#waiting").fadeOut("normal");$(".mask-decimal").each(function(){var t=$(this);t.val(format.number.toDecimal(t.val()))});if($("#ajaxSuccess").attr("value")=="true")return false;else $("#waiting").after('<input type="hidden" id="ajaxSuccess" value="true"/>');$("table.list").dataTable(dTableConfig);
$(".buttonset").buttonset();$(".mask-phone").mask("(99) 9999-9999? r.9999",{placeholder:" "});$(".mask-cnpj").mask("99.999.999/9999-99",{placeholder:" "});$(".mask-code").mask("aaa.***.***.***",{placeholder:" "});$(".mask-cep").mask("99999-999",{placeholder:" "});$(".mask-decimal").each(function(){var t=$(this);var d=t.attr("decimal");var conf={prefix:"",centsSeparator:",",thousandsSeparator:"."};if(d!==undefined){d=d.split(",");if(d.length==2){if(!isNaN(d[0]))conf.limit=d[0]*1;if(!isNaN(d[1]))conf.centsLimit=
d[1]*1}}t.priceFormat(conf)});$(".toggleable").each(function(){toggle=$(this);title=toggle.hide().prev();title.css("cursor","pointer");title.prepend('<span class="ui-icon ui-icon-triangle-1-e" style="display:inline-block"></span>');title.click(function(){t=$(this);t.next().slideToggle();ind=$("span",t);ind.toggleClass("ui-icon-triangle-1-e");ind.toggleClass("ui-icon-triangle-1-s")})});$(".datepicker").datepicker({"dateFormat":"yy-mm-dd"});$(".autocomplete").each(function(){var t=$(this);var src=t.attr("source");
var cbk=t.attr("callback");var pref=t.attr("pref");t.autocomplete({source:"/autocomplete/"+src,minLength:3,select:function(event,ui){$.each(ui.item,function(key,val){$("#"+pref+key).val(val)});eval(cbk)}})});message();make_buttons();limit_div_content()});$("body").ajaxError(function(jqXHR,textStatus,errorThrown){thisDialog=$("<div />",{"title":"Erro"}).appendTo(".ui-layout-center");thisDialog.append("<p>Ocorreu algo inesperado no sistema.</p>");thisDialog.append("<p>Informa\u00e7\u00f5es sobre este erro foram enviadas ao administrador do sistema.</p>");
thisDialog.dialog({show:"fade",hide:"fade",buttons:[{text:"Ok",click:function(){thisDialog.dialog("close")}}],close:function(event,ui){thisDialog.dialog("destroy");thisDialog.remove()}});$("#waiting").fadeOut("normal");$(".mask-decimal").each(function(){var t=$(this);t.val(format.number.toDecimal(t.val()))})});$("#calendar").datepicker();message();limit_div_content();set_timeout();$(document).bind("mousemove click keypress scroll",reset_timer);$("#chatMessage").bind("keypress",function(event){if(event.which==
13){$(".chat-history").append('<p><span class="chat-who">Usu\u00e1rio: </span>'+$(this).val()+"</p>");$(this).val("");$(".chat-history").attr({scrollTop:$(".chat-history").attr("scrollHeight")})}})});$(window).bind("resize",limit_div_content);function message(){msg=$(".notice").text();$(".notice").remove();if(msg!==""){$("#jGrowl").show();$.jGrowl(msg,{life:5E3,position:"center",header:"<b>MENSAGEM</b>",close:function(){$("#jGrowl").hide()}})}}
function limit_div_content(){center=$(".ui-layout-center").outerHeight();mnu=$("#menu_wrapper").outerHeight();$("#content_wrapper").outerHeight(center-mnu)}function make_buttons(){$(".button").each(function(){t=$(this);params={icons:{primary:""},text:true};icn=t.attr("icon");if(icn!==undefined&&icn!=="")params.icons.primary="ui-icon-"+icn;txt=t.attr("caption");if(txt!==undefined&&txt!==""&&txt=="false")params.text=false;t.button(params)})}
function toCurrency(nStr){nStr+="";x=nStr.split(".");x1=x[0];x2=x.length>1?","+x[1]:"";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1))x1=x1.replace(rgx,"$1"+"."+"$2");return x1+x2}var timer;function reset_timer(){window.clearInterval(timer);set_timeout()}function set_timeout(){timer=setInterval("logout()",5*6E4)}function logout(){$.get("/user_session/timeout.json",function(force_logout){if(force_logout)window.location="/logout"})}
function showDialog(url){rdm=Math.floor(Math.random()*1001);ctr="ctr"+rdm;ifm="ifm"+rdm;dlH=280;$(".ui-layout-center").append('<div id="'+ctr+'" title="Upload de arquivo" />');contnr=$("#"+ctr);contnr.html('<iframe id="'+ifm+'" name="'+ifm+'" width="100%" height="100%" marginWidth="0" marginHeight="0" frameBorder="0" scrolling="auto" />');contnr.dialog({modal:true,show:"fade",height:215,width:550,hide:"fade",buttons:[{text:"Enviar",click:function(){$("#waiting",frames[ifm].document).fadeTo("normal",
0.7);$("form",frames[ifm].document).submit();if(contnr.dialog("option","height")!=dlH)contnr.dialog("option","height",dlH)}}],close:function(event,ui){contnr.dialog("destroy");$("#"+ifm).remove()}});$("#"+ifm).attr("src",url);return false}function removeParentTR(ref){var obj=findParent(ref,"tr");obj.remove()}function findParent(ref,parentSelector){var obj=ref.parent();while(!obj.is(parentSelector))obj=obj.parent();return obj}
var format={decimal:{toNumber:function(val){return val.replace(/\./g,"").replace(",",".")*1}},number:{toDecimal:function(val){val=val+"";return val.replace(/[.]/g,",").replace(/\d(?=(?:\d{3})+(?:\D))/g,"$&.")}}};