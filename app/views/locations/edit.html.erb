<% content_for :menu do -%>
  <h1>Editando locação</h1>
  <%= mount_menu %>
<% end -%>

<% form_for(@location) do |f| %>
  <%= f.error_messages %>

  <%= f.text_field   :number                                      , :label => "Número"                , :size => 10 , :disabled => "disabled" %>
  <%= f.text_field   :contact                                     , :label => "Contato"               , :size => 20  %>
  <%= f.hidden_field :client_id                                   , :label => "Id do Cliente"         , :size => 20  %>
  <%= f.text_field   :client_name                                 , :label => "Cliente"               , :size => 30 , :class => "autocomplete", :source => "client", :prefix => "location_", :required => true %>
  <%= f.hidden_field :seller_id                                   , :label => "Id do Representante"   , :size => 20  %>
  <%= f.text_field   :seller_name                                 , :label => "Representante"         , :size => 30 , :class => "autocomplete", :source => "seller", :prefix => "location_", :required => true %>
  <%= f.check_box    :quotation                                   , :label => "Cotação?"              , :size => 10  %>
  <%= f.text_field   :comission                                   , :label => "Comissão"              , :size => 20  %>
  <%= f.select       :payment_condition_id, (@payment_conds || []), :label => "Condições de pagamento", :size => 20  %>
  <%= f.text_field   :starts_at                                   , :label => "Início da locação"     , :size => 20 , :class => "datepicker", :required => true %>
  <%= f.text_field   :ends_at                                     , :label => "Término da locação"    , :size => 20 , :class => "datepicker" %>
  <%= f.text_area    :observation                                 , :label => "Observações"           , :size => 100 %>

  <% field_set_tag 'Itens' do -%>
    <%= new_location_item_toolbar f %>
    <% f.fields_for :location_items, @item_form do |soi| %>
      <%= render :partial => "location_item_fields", :locals => {:f => soi} %>
    <% end -%>

    <table id="location_items" cellpading="0" cellspacing="0" border="0" width="100%">
      <thead>
        <tr>
          <th>Id do item       </th>
          <th>Id Produto       </th>
          <th>Produto          </th>
          <th>Quantidade       </th>
          <th>Valor Unitário   </th>
          <th>Valor Total      </th>
        </tr>
      </thead>
      <tbody>
      <% f.fields_for :location_items, @grid do |soi| %>
        <tr>
          <td><%= soi.hidden_field :id                                                                             %><span></span></td>
          <td><%= soi.hidden_field :product_id                                                                     %><span></span></td>
          <td><%= soi.hidden_field :product_name, :value => (soi.object.prod_name rescue soi.object.product_name ) %><span></span></td>
          <td><%= soi.hidden_field :quantity                                                                       %><span></span></td>
          <td><%= soi.hidden_field :unit_value                                                                     %><span></span></td>
          <td><%= soi.hidden_field :total_value                                                                    %><span></span></td>
        </tr>
      <% end -%>
      </tbody>
    </table>
  <% end -%>
  <div id="trash" class="hide"></div>

<% end %>
